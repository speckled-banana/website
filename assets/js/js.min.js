const page=window.location,contactServer="https://contact.speckledbanana.com/contact";let currentAlert;const formTitle="<h2>Contact Speckled Banana</h2>",formIntroHTML='<p>You can send us a message using the contact form below or alternatively reach us directly on:</p>\n          <p>\n            +44 (0)7934 579448 or\n            <a href="mailto:hello@speckledbanana.com">hello@speckledbanana.com</a>.\n          </p>\n\n          <hr />',formHTML=`<form onsubmit="sendMsg()"\n    class="contact column"\n    id="contact-form"\n  >\n    <label for="contact-email">Your email</label>\n    <input\n      type="email"\n      name="email"\n      id="contact-email"\n      required\n    />\n    <label class="form-error" id="contact-email-error" for="contact-email">❗ Please enter a valid email address</label>\n    <label for="contact-message">Message</label>\n    <textarea\n      name="message"\n      id="contact-message"\n      required\n    ></textarea>\n    <label class="form-error" id="contact-message-error" for="contact-message">❗ Please enter a message</label>\n    <label\n      for="info"\n      class="contact-info"\n    >\n      Info\n    </label>\n    <input\n      type="text"\n      name="info"\n      id="contact-info"\n      class="contact-info"\n    />\n    <input\n      type="text"\n      name="source"\n      id="contact-source"\n      class="contact-info"\n      value="${page}"\n    />\n    <div class="row consent">\n      <input\n        type="checkbox"\n        name="gdpr"\n        id="gdpr"\n      />\n      <label for="gdpr">\n        I'm happy for my data to be used to respond to my query.<p>We won't store or use your email address for any other purpose.  More details can be found in our <a href="./privacy-policy.html">privacy policy</a>.</p>\n      </label>\n    </div>\n\n    <button\n      type="submit"\n      id="contact-submit-button"\n      disabled\n    >\n      Send Message\n    </button>\n    <div id="form-sending"><div class="sending">Sending<span></span></div></div>\n  </form>\n     `,placeholder=document.getElementById("contact-placeholder");placeholder&&(placeholder.innerHTML=formTitle+(page.toString().indexOf("contact-us")>0?formIntroHTML:"")+formHTML);const form=document.getElementById("contact-form"),gdpr=document.getElementById("gdpr"),submitBtn=document.getElementById("contact-submit-button");let errCount=0;form&&form.addEventListener("submit",e=>{e.preventDefault()}),gdpr&&(gdpr.checked?submitBtn.disabled=!1:submitBtn.disabled=!0,form.addEventListener("change",e=>{gdpr.checked?submitBtn.disabled=!1:submitBtn.disabled=!0}));const sendMsg=async()=>{form.elements.disabled=!0,form.classList.toggle("loading",!0);const e=new FormData(form);await fetch(contactServer,{method:"POST",body:e}).then(e=>{if(200!=e.status)throw new Error("Message send failure");return e}).then(e=>{form.classList.toggle("loading",!1),form.elements.disabled=!1,form.classList.toggle("success",!0),alertHandler("<p>Message sent.</p><p>We'll be in touch as soon as possible.</p>","success",5e3)}).catch(e=>{processErr()})},alertHandler=(e,t,n=0)=>{const a=document.getElementById("alert-container");if(a.childElementCount<2){const o=document.createElement("div");o.classList.add("alert","slide-in",t);const r=document.createElement("div");r.classList.add("alert-icon");const l=document.createTextNode("success"===t?"✅":"❌");r.appendChild(l);const s=document.createElement("div");if(s.classList.add("alert-msg"),s.innerHTML+=e,o.appendChild(r),o.appendChild(s),0===n){const e=document.createElement("span");e.textContent="X",e.classList.add("close-btn"),e.onclick=(()=>{slideOut(currentAlert)}),o.appendChild(e)}a.insertBefore(o,a.childNodes[0]),currentAlert=a.childNodes[0],a.childNodes.length>1&&a.removeChild(a.lastChild),n>0&&setTimeout(function(){slideOut(currentAlert)},n)}},slideOut=e=>{e.classList.add("slide-out"),resetForm(e.classList.contains("failure")?"failure":"")},processErr=()=>{form.classList.toggle("loading",!1),form.elements.disabled=!1,form.classList.toggle("failure",!0),0==errCount?alertHandler("<p>Sorry, that message didn't send.</p><p>Hopefully it was just a momentary blip, please retry.</p>","failure",3e3):alertHandler(`<p>Sorry, something is still broken.</p>\n          <p>\n            <a href="mailto:hello@speckledbanana.com?subject=Contact%20Form%20Error!&body=${encodeURIComponent("Contact form error on: "+page+"\n\n============================================\n\n"+document.getElementById("contact-message").value)}" target="_blank" rel="noopener noreferrer">Click here to open the message in your default email application</a></p>\n          <p>Alternatively give us a call on +44 (0)7934 579448</p>`,"failure")},resetForm=e=>{if(console.log(errCount),e){if(form.classList.toggle("failure",!1),0===errCount)return void errCount++;errCount=0}else form.classList.toggle("success",!1);document.getElementById("contact-email").value=null,document.getElementById("contact-message").value=null,document.getElementById("contact-info").value=null,gdpr.checked=!1},copyright=document.getElementById("copyright"),year=(new Date).getFullYear();copyright.innerText=`Copyright ©${year} Speckled Banana Ltd. All Rights Reserved`;